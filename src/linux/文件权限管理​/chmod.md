---
title: chmod命令-文件权限设置
category:
  - Linux
  - 文件权限管理
tag:
  - chmod
  - 文件权限
  - 系统安全
  - 权限管理
date: 2022-07-30

---

# chmod命令-文件权限设置

## 概述

`chmod` 命令来自英文词组 "change mode" 的缩写，是 Linux 系统中用于改变文件或目录权限的重要命令。默认只有文件的所有者和管理员可以设置文件权限，普通用户只能管理自己文件的权限属性。

## 语法格式

```bash
chmod [参数] [权限设置] [文件或目录]
```

### 基本格式

1. **符号模式**：
   ```bash
   chmod [-cfRv][--help][--version][<权限范围>+/-/=<权限设置...>][文件或目录...]
   ```

2. **数字模式**：
   ```bash
   chmod [-cfRv][--help][--version][数字代号][文件或目录...]
   ```

3. **参考模式**：
   ```bash
   chmod [-cfRv][--reference=<参考文件或目录>][--version][文件或目录...]
   ```

## 常用参数

| 参数 | 说明 |
|------|------|
| `-c, --changes` | 只在权限改变时输出信息，效果类似 `-v` 参数 |
| `-f, --quiet, --silent` | 改变权限失败后不显示错误信息 |
| `-R, --recursive` | 递归处理所有子文件和子目录 |
| `-v, --verbose` | 显示执行过程的详细信息 |
| `--help` | 显示帮助信息 |
| `--version` | 显示版本信息 |
| `--reference=<文件>` | 使用指定参考文件的权限设置 |
| `--no-preserve-root` | 不特殊对待根目录 |
| `--preserve-root` | 禁止对根目录进行递归操作（默认） |

## 权限范围表示

### 用户类别

| 符号 | 含义 | 说明 |
|------|------|------|
| `u` | User | 文件或目录的拥有者 |
| `g` | Group | 文件或目录的所属群组 |
| `o` | Others | 除拥有者和所属群组外的其他用户 |
| `a` | All | 所有用户（包含 u、g、o） |

### 权限类型

| 符号 | 权限 | 数字代号 | 说明 |
|------|------|----------|------|
| `r` | 读取权限 | 4 | 可以读取文件内容或列出目录内容 |
| `w` | 写入权限 | 2 | 可以修改文件内容或在目录中创建/删除文件 |
| `x` | 执行权限 | 1 | 可以执行文件或进入目录 |
| `-` | 无权限 | 0 | 不具有任何权限 |

### 操作符

| 符号 | 说明 |
|------|------|
| `+` | 添加指定权限 |
| `-` | 移除指定权限 |
| `=` | 设置权限为指定值（会清除其他权限） |

## 设置方法

### 1. 文字设定法（符号模式）

#### 基本语法
```bash
chmod [who] [+|-|=] [mode] 文件名
```

#### 示例

**基础权限设置：**
```bash
# 给所有用户添加执行权限
chmod a+x old.sh

# 给文件所有者和同组用户添加读权限
chmod ug+r file1.txt
# 或者给所有人添加读权限
chmod a+r file1.txt

# 给所有者和同组用户添加写权限，其他用户移除写权限
chmod ug+w,o-w file1.txt file2.txt

# 只给文件所有者添加执行权限
chmod u+x ex1.py

# 递归设置目录及其子文件/目录为所有人可读
chmod -R a+r *
```

**组合权限设置：**
```bash
# 设置同组和其他用户对文件有读权限
chmod g+r,o+r example

# 设置文件属主增加写权限，同组用户增加写权限，其他用户删除执行权限
chmod ug+w,o-x text
```

### 2. 数字设定法（八进制模式）

#### 权限计算方法
- 读权限 (r) = 4
- 写权限 (w) = 2
- 执行权限 (x) = 1
- 无权限 (-) = 0

权限组合通过数字相加获得：
- 7 = 4+2+1 (rwx)
- 6 = 4+2 (rw-)
- 5 = 4+1 (r-x)
- 4 = 4 (r--)
- 3 = 2+1 (-wx)
- 2 = 2 (-w-)
- 1 = 1 (--x)
- 0 = 0 (---)

#### 示例

```bash
# 设置文件权限为 644 (-rw-r--r--)
# 所有者：读写(6)，组用户：读(4)，其他用户：读(4)
chmod 644 mm.txt

# 设置文件权限为 755 (-rwxr-xr-x)
# 所有者：读写执行(7)，组用户：读执行(5)，其他用户：读执行(5)
chmod 755 script.sh

# 设置文件权限为 750 (-rwxr-x---)
chmod 750 wch.txt

# 设置文件权限为 777 (-rwxrwxrwx) - 不推荐
chmod 777 file
```

## 常见权限设置

### 文件权限

| 八进制 | 符号表示 | 权限说明 | 使用场景 |
|--------|----------|----------|----------|
| 600 | -rw------- | 只有所有者可读写 | 私人文件、配置文件 |
| 644 | -rw-r--r-- | 所有者可读写，其他人只读 | 一般文档文件 |
| 666 | -rw-rw-rw- | 所有人可读写 | 不推荐使用 |
| 700 | -rwx------ | 只有所有者可读写执行 | 私人脚本 |
| 755 | -rwxr-xr-x | 所有者可读写执行，其他人可读执行 | 系统程序、脚本 |
| 711 | -rwx--x--x | 所有者可读写执行，其他人只能执行 | 特殊程序 |
| 777 | -rwxrwxrwx | 所有人可读写执行 | 极不推荐 |

### 目录权限

| 八进制 | 符号表示 | 权限说明 |
|--------|----------|----------|
| 700 | drwx------ | 只有所有者可访问 |
| 755 | drwxr-xr-x | 所有者可读写，其他人可读 |
| 750 | drwxr-x--- | 所有者可读写，组用户可读 |

## 特殊权限

### SUID (Set User ID)
- 数字代号：4
- 作用：执行文件时临时获得文件所有者权限
- 示例：
  ```bash
  chmod u+s a.out
  chmod 4755 filename  # 等价于 chmod u+s,755 filename
  ```

### SGID (Set Group ID)
- 数字代号：2
- 作用：执行文件时临时获得文件所属组权限
- 示例：
  ```bash
  chmod g+s filename
  chmod 2755 filename
  ```

### Sticky Bit
- 数字代号：1
- 作用：对目录设置后，只有文件所有者才能删除目录中的文件
- 示例：
  ```bash
  chmod +t directory
  chmod 1755 directory
  ```

### 组合特殊权限
```bash
chmod 4755 file  # SUID + 755 权限
chmod 6755 file  # SUID + SGID + 755 权限
chmod 7755 file  # SUID + SGID + Sticky + 755 权限
```

## 实用示例

### 常用操作示例

```bash
# 设置脚本文件可执行
chmod +x script.sh

# 设置配置文件只有所有者可读写
chmod 600 config.conf

# 设置目录及所有子文件为644权限
chmod -R 644 /path/to/directory

# 设置Web目录权限（常见设置）
chmod -R 755 /var/www/html/
chmod -R 644 /var/www/html/*.html

# 设置日志文件可追加写入
chmod 664 /var/log/app.log

# 移除所有用户的执行权限
chmod a-x filename
# 等价写法
chmod -x filename
chmod ugo-x filename
```

### 批量操作示例

```bash
# 设置当前目录所有.sh文件可执行
chmod +x *.sh

# 设置多个文件权限
chmod 644 file1.txt file2.txt file3.txt

# 使用参考文件设置权限
chmod --reference=reference_file target_file

# 递归设置目录权限，但只显示变更的文件
chmod -Rc 755 /path/to/directory
```

## 注意事项

1. **权限继承**：新创建的文件会继承默认权限（由 umask 控制）

2. **符号链接**：chmod 修改符号链接时，实际修改的是被链接的原始文件

3. **安全考虑**：
   - 避免设置 777 权限（所有用户完全控制）
   - 谨慎使用 SUID/SGID 权限
   - 定期检查系统中的特殊权限文件

4. **目录权限**：
   - 目录的执行权限(x)表示可以进入该目录
   - 目录的读权限(r)表示可以列出目录内容
   - 目录的写权限(w)表示可以在目录中创建/删除文件

5. **权限检查**：使用 `ls -l` 命令查看文件权限设置

## 相关命令

- `chown`：改变文件所有者
- `chgrp`：改变文件所属组
- `umask`：设置默认权限掩码
- `ls -l`：查看文件详细权限信息

## 总结

chmod 命令是 Linux 系统管理中的基础工具，正确理解和使用文件权限对于系统安全至关重要。建议在实际使用中：

- 优先使用数字模式进行精确控制
- 对重要文件和目录设置适当的权限
- 定期审查系统权限设置
- 避免过度开放的权限设置

通过合理的权限设置，可以有效保护系统安全，防止未授权访问和恶意操作。
