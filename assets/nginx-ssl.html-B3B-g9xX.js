import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as h,b as i,a as p,e as n,w as l,r as k,o as r,d as e}from"./app-Chw5Q7wx.js";const d={},A={class:"table-of-contents"};function g(o,s){const a=k("router-link");return r(),h("div",null,[s[16]||(s[16]=i("h1",{id:"nginx-ssl证书配置指南-优化版",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#nginx-ssl证书配置指南-优化版"},[i("span",null,"Nginx SSL证书配置指南（优化版）")])],-1)),s[17]||(s[17]=i("h2",{id:"目录",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#目录"},[i("span",null,"目录")])],-1)),i("nav",A,[i("ul",null,[i("li",null,[n(a,{to:"#目录"},{default:l(()=>s[0]||(s[0]=[e("目录")])),_:1,__:[0]})]),i("li",null,[n(a,{to:"#一、nginx配置文件示例"},{default:l(()=>s[1]||(s[1]=[e("一、Nginx配置文件示例")])),_:1,__:[1]}),i("ul",null,[i("li",null,[n(a,{to:"#_1-http重定向到https配置"},{default:l(()=>s[2]||(s[2]=[e("1. HTTP重定向到HTTPS配置")])),_:1,__:[2]})]),i("li",null,[n(a,{to:"#_2-https服务器配置"},{default:l(()=>s[3]||(s[3]=[e("2. HTTPS服务器配置")])),_:1,__:[3]})])])]),i("li",null,[n(a,{to:"#二、配置说明与注意事项"},{default:l(()=>s[4]||(s[4]=[e("二、配置说明与注意事项")])),_:1,__:[4]}),i("ul",null,[i("li",null,[n(a,{to:"#_1-证书文件准备"},{default:l(()=>s[5]||(s[5]=[e("1. 证书文件准备")])),_:1,__:[5]})]),i("li",null,[n(a,{to:"#_2-安全改进点"},{default:l(()=>s[6]||(s[6]=[e("2. 安全改进点")])),_:1,__:[6]})]),i("li",null,[n(a,{to:"#_3-性能优化"},{default:l(()=>s[7]||(s[7]=[e("3. 性能优化")])),_:1,__:[7]})]),i("li",null,[n(a,{to:"#_4-端口开放"},{default:l(()=>s[8]||(s[8]=[e("4. 端口开放")])),_:1,__:[8]})]),i("li",null,[n(a,{to:"#_5-证书申请推荐"},{default:l(()=>s[9]||(s[9]=[e("5. 证书申请推荐")])),_:1,__:[9]})]),i("li",null,[n(a,{to:"#_6-证书格式说明"},{default:l(()=>s[10]||(s[10]=[e("6. 证书格式说明")])),_:1,__:[10]})])])]),i("li",null,[n(a,{to:"#三、测试与验证"},{default:l(()=>s[11]||(s[11]=[e("三、测试与验证")])),_:1,__:[11]}),i("ul",null,[i("li",null,[n(a,{to:"#_1-配置语法检查"},{default:l(()=>s[12]||(s[12]=[e("1. 配置语法检查")])),_:1,__:[12]})]),i("li",null,[n(a,{to:"#_2-ssl配置测试"},{default:l(()=>s[13]||(s[13]=[e("2. SSL配置测试")])),_:1,__:[13]})]),i("li",null,[n(a,{to:"#_3-重新加载配置"},{default:l(()=>s[14]||(s[14]=[e("3. 重新加载配置")])),_:1,__:[14]})])])]),i("li",null,[n(a,{to:"#四、常见问题排查"},{default:l(()=>s[15]||(s[15]=[e("四、常见问题排查")])),_:1,__:[15]})])])]),s[18]||(s[18]=p(`<h2 id="一、nginx配置文件示例" tabindex="-1"><a class="header-anchor" href="#一、nginx配置文件示例"><span>一、Nginx配置文件示例</span></a></h2><h3 id="_1-http重定向到https配置" tabindex="-1"><a class="header-anchor" href="#_1-http重定向到https配置"><span>1. HTTP重定向到HTTPS配置</span></a></h3><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-nginx"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    listen </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 填写绑定证书的域名（注意：这里只需要域名，不需要http://前缀）</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    server_name </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">miliqkadmin.motopa.cn;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 将HTTP请求重定向到HTTPS，确保网站安全性</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 301</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> https://$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">server_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">request_uri</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-https服务器配置" tabindex="-1"><a class="header-anchor" href="#_2-https服务器配置"><span>2. HTTPS服务器配置</span></a></h3><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-nginx"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 监听443端口并启用SSL</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    listen </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">443</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ssl http2;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 服务器域名（注意：这里只需要域名，不需要https://前缀）</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    server_name </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">miliqkadmin.motopa.cn;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ============== SSL证书配置开始 ==============</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # SSL证书文件路径（公钥证书）</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ssl_certificate </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/etc/nginx/ssl/fullchain.cer;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # SSL私钥文件路径</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ssl_certificate_key </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/etc/nginx/ssl/miliqkadmin.motopa.cn.key;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # SSL会话缓存配置</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ssl_session_cache </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">shared:SSL:10m;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ssl_session_timeout </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 支持的SSL/TLS协议版本（推荐只使用TLS 1.2和1.3）</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ssl_protocols </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">TLSv1.2 TLSv1.3;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 加密套件配置（现代化、安全的配置）</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ssl_ciphers </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ssl_prefer_server_ciphers </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">off</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 启用OCSP装订</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ssl_stapling </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ssl_stapling_verify </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 安全头部配置</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    add_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Strict-Transport-Security </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;max-age=31536000; includeSubDomains&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> always;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    add_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">X-Frame-Options DENY always;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    add_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">X-Content-Type-Options nosniff always;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    add_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">X-XSS-Protection </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1; mode=block&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> always;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ============== SSL证书配置结束 ==============</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # API代理配置</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /api/ {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_pass </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">http://127.0.0.1:9330/;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 代理头部设置</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_set_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Host $</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_set_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">X-Real-IP $</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">remote_addr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_set_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">X-Forwarded-For $</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">proxy_add_x_forwarded_for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_set_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">X-Forwarded-Proto $</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">scheme</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # WebSocket支持</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_http_version </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_set_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Upgrade $</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">http_upgrade</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_set_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Connection </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;upgrade&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 客户端请求配置</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        client_max_body_size </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">100m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        client_body_buffer_size </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">128k</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 代理超时配置</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_connect_timeout </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_send_timeout </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_read_timeout </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 代理缓冲配置</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_buffer_size </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4k</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_buffers </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 32k</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_busy_buffers_size </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">64k</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_temp_file_write_size </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">64k</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 静态文件配置</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ^~ </span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">/fmsf </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        root </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/home/daizhao/static/miliqk;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        expires </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">30d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        access_log </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">off</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 静态文件缓存控制</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        add_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Cache-Control </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;public, immutable&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 前端应用配置</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> / {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        root </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/home/daizhao/web/miliqk-manage-web-dev;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        try_files </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">uri</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> $</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">uri</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/ /index.html;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        index </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">index.html index.htm;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 设置前端文件缓存</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ~* </span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">\\.(js|css|png|jpg|jpeg|gif|ico|svg)$ </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            expires </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1y;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            add_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Cache-Control </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;public, immutable&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 错误页面配置</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    error_page </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">500</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 502</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 503</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 504</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /50x.html;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">/50x.html </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        root </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/usr/share/nginx/html;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、配置说明与注意事项" tabindex="-1"><a class="header-anchor" href="#二、配置说明与注意事项"><span>二、配置说明与注意事项</span></a></h2><h3 id="_1-证书文件准备" tabindex="-1"><a class="header-anchor" href="#_1-证书文件准备"><span>1. 证书文件准备</span></a></h3><ul><li><strong>证书文件</strong>：<code>/etc/nginx/ssl/fullchain.cer</code>（包含完整证书链）</li><li><strong>私钥文件</strong>：<code>/etc/nginx/ssl/miliqkadmin.motopa.cn.key</code></li><li><strong>文件权限</strong>：建议设置为600或644，确保nginx用户可读</li></ul><h3 id="_2-安全改进点" tabindex="-1"><a class="header-anchor" href="#_2-安全改进点"><span>2. 安全改进点</span></a></h3><ul><li><strong>协议版本</strong>：只使用TLS 1.2和1.3，移除了不安全的TLS 1.0和1.1</li><li><strong>加密套件</strong>：使用现代化的加密算法，提高安全性</li><li><strong>HTTP/2支持</strong>：启用HTTP/2协议，提升性能</li><li><strong>安全头部</strong>：添加HSTS、XSS保护等安全头部</li><li><strong>OCSP装订</strong>：启用OCSP装订，提高SSL握手性能</li></ul><h3 id="_3-性能优化" tabindex="-1"><a class="header-anchor" href="#_3-性能优化"><span>3. 性能优化</span></a></h3><ul><li><strong>SSL会话缓存</strong>：共享SSL会话缓存，减少握手次数</li><li><strong>静态文件缓存</strong>：为静态资源设置长期缓存</li><li><strong>Gzip压缩</strong>：建议在http块中启用gzip压缩</li></ul><h3 id="_4-端口开放" tabindex="-1"><a class="header-anchor" href="#_4-端口开放"><span>4. 端口开放</span></a></h3><p>确保防火墙开放以下端口：</p><ul><li><strong>80端口</strong>：HTTP流量（重定向用）</li><li><strong>443端口</strong>：HTTPS流量</li></ul><h3 id="_5-证书申请推荐" tabindex="-1"><a class="header-anchor" href="#_5-证书申请推荐"><span>5. 证书申请推荐</span></a></h3><ul><li><strong>Let&#39;s Encrypt</strong>：免费SSL证书，支持自动续期</li><li><strong><a href="http://acme.sh" target="_blank" rel="noopener noreferrer">acme.sh</a></strong>：自动化证书管理工具</li><li><strong>Certbot</strong>：Let&#39;s Encrypt官方客户端</li></ul><h3 id="_6-证书格式说明" tabindex="-1"><a class="header-anchor" href="#_6-证书格式说明"><span>6. 证书格式说明</span></a></h3><ul><li><strong>PEM格式</strong>：最常用的证书格式，文本格式</li><li><strong>CER格式</strong>：二进制或Base64编码的证书</li><li><strong>JKS格式</strong>：Java密钥库格式</li><li><strong>PKCS12格式</strong>：包含私钥和证书的格式</li></ul><h2 id="三、测试与验证" tabindex="-1"><a class="header-anchor" href="#三、测试与验证"><span>三、测试与验证</span></a></h2><h3 id="_1-配置语法检查" tabindex="-1"><a class="header-anchor" href="#_1-配置语法检查"><span>1. 配置语法检查</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-ssl配置测试" tabindex="-1"><a class="header-anchor" href="#_2-ssl配置测试"><span>2. SSL配置测试</span></a></h3><p>使用在线工具测试SSL配置：</p><ul><li>SSL Labs：<a href="https://www.ssllabs.com/ssltest/" target="_blank" rel="noopener noreferrer">https://www.ssllabs.com/ssltest/</a></li><li>MySSL：<a href="https://myssl.com/" target="_blank" rel="noopener noreferrer">https://myssl.com/</a></li></ul><h3 id="_3-重新加载配置" tabindex="-1"><a class="header-anchor" href="#_3-重新加载配置"><span>3. 重新加载配置</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="四、常见问题排查" tabindex="-1"><a class="header-anchor" href="#四、常见问题排查"><span>四、常见问题排查</span></a></h2><ol><li><strong>证书路径错误</strong>：检查证书文件路径和权限</li><li><strong>域名不匹配</strong>：确保server_name与证书域名一致</li><li><strong>端口被占用</strong>：检查80和443端口是否被其他程序使用</li><li><strong>防火墙阻拦</strong>：确认防火墙规则允许443端口访问</li></ol><hr><p><em>参考链接：</em></p><ul><li><em>SSL证书格式介绍：<a href="https://blog.freessl.cn/ssl-cert-format-introduce/" target="_blank" rel="noopener noreferrer">https://blog.freessl.cn/ssl-cert-format-introduce/</a></em></li><li><em>ACME客户端快速入门：<a href="https://blog.freessl.cn/acme-quick-start/" target="_blank" rel="noopener noreferrer">https://blog.freessl.cn/acme-quick-start/</a></em></li></ul>`,32))])}const B=t(d,[["render",g]]),u=JSON.parse(`{"path":"/linux/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E4%B8%8E%E5%8C%85%E7%AE%A1%E7%90%86/nginx-ssl.html","title":"nginx配置ssl证书","lang":"zh-CN","frontmatter":{"title":"nginx配置ssl证书","category":["Linux","软件安装与包管理"],"tag":["nginx","ssl证书","服务管理"],"date":"2022-09-25T00:00:00.000Z","description":"Nginx SSL证书配置指南（优化版） 目录 一、Nginx配置文件示例 1. HTTP重定向到HTTPS配置 2. HTTPS服务器配置 二、配置说明与注意事项 1. 证书文件准备 证书文件：/etc/nginx/ssl/fullchain.cer（包含完整证书链） 私钥文件：/etc/nginx/ssl/miliqkadmin.motopa.cn...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"nginx配置ssl证书\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-09-25T00:00:00.000Z\\",\\"dateModified\\":\\"2025-08-02T10:09:34.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"tuonioooo\\",\\"url\\":\\"/\\"}]}"],["meta",{"property":"og:url","content":"https://mister-hope.github.io/devops-docs/linux/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E4%B8%8E%E5%8C%85%E7%AE%A1%E7%90%86/nginx-ssl.html"}],["meta",{"property":"og:site_name","content":"tuonioooo's DevOps Docs"}],["meta",{"property":"og:title","content":"nginx配置ssl证书"}],["meta",{"property":"og:description","content":"Nginx SSL证书配置指南（优化版） 目录 一、Nginx配置文件示例 1. HTTP重定向到HTTPS配置 2. HTTPS服务器配置 二、配置说明与注意事项 1. 证书文件准备 证书文件：/etc/nginx/ssl/fullchain.cer（包含完整证书链） 私钥文件：/etc/nginx/ssl/miliqkadmin.motopa.cn..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-08-02T10:09:34.000Z"}],["meta",{"property":"article:tag","content":"服务管理"}],["meta",{"property":"article:tag","content":"ssl证书"}],["meta",{"property":"article:tag","content":"nginx"}],["meta",{"property":"article:published_time","content":"2022-09-25T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-08-02T10:09:34.000Z"}]]},"git":{"createdTime":1754129374000,"updatedTime":1754129374000,"contributors":[{"name":"tuonioooo","username":"tuonioooo","email":"daizhaoman@sina.com","commits":1,"url":"https://github.com/tuonioooo"}]},"readingTime":{"minutes":3.22,"words":967},"filePathRelative":"linux/软件安装与包管理/nginx-ssl.md","excerpt":"\\n<h2>目录</h2>\\n\\n<h2>一、Nginx配置文件示例</h2>\\n<h3>1. HTTP重定向到HTTPS配置</h3>\\n<div class=\\"language-nginx line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"nginx\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-nginx\\"><span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">server</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> {</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">    listen </span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">80</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">    # 填写绑定证书的域名（注意：这里只需要域名，不需要http://前缀）</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">    server_name </span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">miliqkadmin.motopa.cn;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">    </span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">    # 将HTTP请求重定向到HTTPS，确保网站安全性</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">    return</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> 301</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> https://$</span><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">server_name</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">$</span><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">request_uri</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">}</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{B as comp,u as data};
