import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as n,o as e}from"./app-aR2NjaSw.js";const l={};function h(t,s){return e(),a("div",null,s[0]||(s[0]=[n(`<h1 id="su和sudo的区别与使用指南" tabindex="-1"><a class="header-anchor" href="#su和sudo的区别与使用指南"><span>su和sudo的区别与使用指南</span></a></h1><h2 id="一、使用-su-命令临时切换用户身份" tabindex="-1"><a class="header-anchor" href="#一、使用-su-命令临时切换用户身份"><span>一、使用 su 命令临时切换用户身份</span></a></h2><h3 id="_1-su-的适用条件和威力" tabindex="-1"><a class="header-anchor" href="#_1-su-的适用条件和威力"><span>1. su 的适用条件和威力</span></a></h3><p>su命令是切换用户的工具。例如，当我们以普通用户beinan登录系统，但需要执行添加用户的任务（useradd命令）时，由于beinan用户没有这个权限，而root用户拥有此权限，我们有两种解决方案：</p><ol><li><strong>方案一</strong>：退出beinan用户，重新以root用户登录（不推荐）</li><li><strong>方案二</strong>：使用su命令切换到root用户执行相关操作，完成后再退出root（推荐）</li></ol><p><strong>权限特点：</strong></p><ul><li>超级用户root向普通或虚拟用户切换<strong>不需要密码</strong></li><li>普通用户切换到任何其他用户都<strong>需要密码验证</strong></li></ul><h3 id="_2-su-的用法" tabindex="-1"><a class="header-anchor" href="#_2-su-的用法"><span>2. su 的用法</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">su</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [选项参数] [用户]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>主要参数：</strong></p><ul><li><code>-, -l, --login</code>：登录并改变到所切换的用户环境</li><li><code>-c, --command=COMMAND</code>：执行一个命令，然后退出所切换到的用户环境</li></ul><h3 id="_3-su-的使用示例" tabindex="-1"><a class="header-anchor" href="#_3-su-的使用示例"><span>3. su 的使用示例</span></a></h3><h4 id="_3-1-基本切换-不改变环境" tabindex="-1"><a class="header-anchor" href="#_3-1-基本切换-不改变环境"><span>3.1 基本切换（不改变环境）</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[beinan@localhost ~]$ su</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Password:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@localhost beinan]# pwd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/home/beinan</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>说明：切换到root用户，但仍在beinan的家目录</em></p><h4 id="_3-2-完全切换-改变环境" tabindex="-1"><a class="header-anchor" href="#_3-2-完全切换-改变环境"><span>3.2 完全切换（改变环境）</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[beinan@localhost ~]$ su -</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Password:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@localhost ~]# pwd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/root</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>说明：切换到root用户并改变到root的环境</em></p><h4 id="_3-3-切换到指定用户" tabindex="-1"><a class="header-anchor" href="#_3-3-切换到指定用户"><span>3.3 切换到指定用户</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[beinan@localhost ~]$ su - linuxsir</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Password:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[linuxsir@localhost ~]$ pwd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/home/linuxsir</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[linuxsir@localhost ~]$ id</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">uid</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">505</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">linuxsir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">gid</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">502</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">linuxsir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groups</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">,500</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">beinan</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">,502</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">linuxsir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-4-执行命令后退出" tabindex="-1"><a class="header-anchor" href="#_3-4-执行命令后退出"><span>3.4 执行命令后退出</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[beinan@localhost ~]$ su - -c ls</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Password:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">anaconda-ks.cfg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Desktop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install.log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install.log.syslog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> testgroup</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[beinan@localhost ~]$ pwd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/home/beinan</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>说明：以root身份执行ls命令后自动退回原用户</em></p><h3 id="_4-su的优缺点" tabindex="-1"><a class="header-anchor" href="#_4-su的优缺点"><span>4. su的优缺点</span></a></h3><p><strong>优点：</strong></p><ul><li>管理方便，通过切换到root可以完成所有系统管理工作</li></ul><p><strong>缺点：</strong></p><ul><li><strong>安全隐患</strong>：需要告诉所有管理员root密码</li><li><strong>权限无限制</strong>：切换后拥有完全的系统权限</li><li><strong>无法追踪</strong>：无法明确哪个管理员执行了哪些操作</li><li><strong>风险高</strong>：任何操作失误都可能导致系统崩溃或数据丢失</li></ul><p><strong>适用场景：</strong></p><ul><li>只有1-2个人参与管理的系统</li><li>不适合多人参与的系统管理</li></ul><hr><h2 id="二、sudo-授权许可使用的受限制su" tabindex="-1"><a class="header-anchor" href="#二、sudo-授权许可使用的受限制su"><span>二、sudo - 授权许可使用的受限制su</span></a></h2><h3 id="_1-sudo-的适用条件" tabindex="-1"><a class="header-anchor" href="#_1-sudo-的适用条件"><span>1. sudo 的适用条件</span></a></h3><p>sudo相比su有以下优势：</p><ul><li><strong>针对性授权</strong>：可以有针对性地下放权限</li><li><strong>无需root密码</strong>：普通用户不需要知道root密码</li><li><strong>相对安全</strong>：被称为&quot;受限制的su&quot;或&quot;授权许可的su&quot;</li><li><strong>操作追踪</strong>：可以记录谁执行了什么操作</li></ul><p><strong>工作流程：</strong><br> 当前用户 → 切换到root（或指定用户） → 执行命令 → 退回当前用户</p><h3 id="_2-sudo配置文件-etc-sudoers" tabindex="-1"><a class="header-anchor" href="#_2-sudo配置文件-etc-sudoers"><span>2. sudo配置文件 /etc/sudoers</span></a></h3><p><strong>编辑方法：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">visudo</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><em>注意：使用visudo编辑器的好处是在规则错误时会提示错误信息</em></p><p><strong>文件规则：</strong></p><ul><li>每行为一个规则</li><li><code>#</code>开头为注释</li><li>长规则可用<code>\\</code>续行</li><li>规则分为两类：别名定义和授权规则</li></ul><h3 id="_3-别名规则定义" tabindex="-1"><a class="header-anchor" href="#_3-别名规则定义"><span>3. 别名规则定义</span></a></h3><h4 id="_3-1-别名定义格式" tabindex="-1"><a class="header-anchor" href="#_3-1-别名定义格式"><span>3.1 别名定义格式</span></a></h4><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>Alias_Type NAME = item1, item2, ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-2-别名类型" tabindex="-1"><a class="header-anchor" href="#_3-2-别名类型"><span>3.2 别名类型</span></a></h4><table><thead><tr><th>别名类型</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><code>Host_Alias</code></td><td>定义主机别名</td><td>主机名、IP地址、网段</td></tr><tr><td><code>User_Alias</code></td><td>定义用户别名</td><td>用户名、用户组（前加%）</td></tr><tr><td><code>Runas_Alias</code></td><td>定义目标用户别名</td><td>sudo允许切换到的用户</td></tr><tr><td><code>Cmnd_Alias</code></td><td>定义命令别名</td><td>系统命令的绝对路径</td></tr></tbody></table><h4 id="_3-3-别名定义示例" tabindex="-1"><a class="header-anchor" href="#_3-3-别名定义示例"><span>3.3 别名定义示例</span></a></h4><p><strong>主机别名：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Host_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HT01=localhost,st05,st04,10.0.0.4,255.255.255.0,192.168.1.0/24</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Host_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HT02=st09,st10</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>用户别名：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">User_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SYSAD=beinan,linuxsir,bnnnb,lanhaitun</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">User_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> NETAD=beinan,bnnb</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">User_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> WEBMASTER=linuxsir</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>命令别名：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Cmnd_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> USERMAG=/usr/sbin/adduser,/usr/sbin/userdel,/usr/bin/passwd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [A-Za-z]*,/bin/chown,/bin/chmod</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Cmnd_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DISKMAG=/sbin/fdisk,/sbin/parted</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Cmnd_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> NETMAG=/sbin/ifconfig,/etc/init.d/network</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Cmnd_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PWMAG=/usr/sbin/reboot,/usr/sbin/halt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>运行身份别名：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Runas_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OP=root,operator</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Runas_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DBADM=mysql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-授权规则" tabindex="-1"><a class="header-anchor" href="#_4-授权规则"><span>4. 授权规则</span></a></h3><h4 id="_4-1-基本格式" tabindex="-1"><a class="header-anchor" href="#_4-1-基本格式"><span>4.1 基本格式</span></a></h4><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>授权用户 主机=命令动作</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_4-2-完整格式" tabindex="-1"><a class="header-anchor" href="#_4-2-完整格式"><span>4.2 完整格式</span></a></h4><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>授权用户 主机=[(切换到的用户)] [是否需要密码验证] 命令1,[(切换到的用户)] [是否需要密码验证] 命令2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_4-3-授权规则示例" tabindex="-1"><a class="header-anchor" href="#_4-3-授权规则示例"><span>4.3 授权规则示例</span></a></h4><p><strong>示例1：基本授权</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">beinan</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL=/bin/chown,/bin/chmod</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><em>说明：beinan用户可以在任何主机上以root身份执行chown和chmod命令</em></p><p><strong>示例2：指定目标用户</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">beinan</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/bin/chown,/bin/chmod</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>示例3：免密码执行</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">beinan</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">NOPASSWD:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /bin/chown,/bin/chmod</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>示例4：实际应用场景</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">beinan</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL=/bin/more</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><em>说明：允许beinan用户以root身份查看文件</em></p><p><strong>示例5：用户组授权</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">%beinan</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL=/usr/sbin/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">,/sbin/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><em>说明：beinan用户组的所有成员可以执行/usr/sbin和/sbin下的所有命令</em></p><p><strong>示例6：禁止特定命令</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">beinan</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL=/usr/sbin/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">,/sbin/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">,!/usr/sbin/fdisk</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><em>说明：可以执行/usr/sbin和/sbin下的所有命令，但fdisk除外</em></p><h4 id="_4-4-别名应用实例" tabindex="-1"><a class="header-anchor" href="#_4-4-别名应用实例"><span>4.4 别名应用实例</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 定义别名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">User_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SYSADER=beinan,linuxsir,%beinan</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">User_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DISKADER=lanhaitun</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Runas_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OP=root</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Cmnd_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SYDCMD=/bin/chown,/bin/chmod,/usr/sbin/adduser,/usr/bin/passwd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [A-Za-z]*,!</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/bin/passwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Cmnd_Alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DSKCMD=/sbin/parted,/sbin/fdisk</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 授权规则</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">SYSADER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL=SYDCMD,DSKCMD</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">DISKADER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">OP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DSKCMD</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-sudo命令使用" tabindex="-1"><a class="header-anchor" href="#_5-sudo命令使用"><span>5. sudo命令使用</span></a></h3><h4 id="_5-1-基本语法" tabindex="-1"><a class="header-anchor" href="#_5-1-基本语法"><span>5.1 基本语法</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [参数选项] 命令</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_5-2-常用参数" tabindex="-1"><a class="header-anchor" href="#_5-2-常用参数"><span>5.2 常用参数</span></a></h4><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td><code>-l</code></td><td>列出用户可用的和被禁止的命令</td></tr><tr><td><code>-v</code></td><td>验证用户的时间戳</td></tr><tr><td><code>-u</code></td><td>指定以某个用户身份执行</td></tr><tr><td><code>-k</code></td><td>删除时间戳，下次需要重新输入密码</td></tr></tbody></table><h4 id="_5-3-使用示例" tabindex="-1"><a class="header-anchor" href="#_5-3-使用示例"><span>5.3 使用示例</span></a></h4><p><strong>查看可用命令：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[beinan@localhost ~]$ sudo -l</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Password:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">User</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> beinan</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> may</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> following</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commands</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> this</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> host:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/bin/chown</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/bin/chmod</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/sbin/adduser</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/bin/passwd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [A-Za-z]*</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) !</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/bin/passwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/sbin/parted</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/sbin/fdisk</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>执行授权命令：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[beinan@localhost ~]$ sudo chown beinan:beinan /opt</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[beinan@localhost ~]$ sudo passwd linuxsir</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Changing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> password</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> linuxsir.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">New</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UNIX</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> password:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Retype</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UNIX</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> password:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">passwd:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> all</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> authentication</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tokens</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> updated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> successfully.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="三、su与sudo的对比总结" tabindex="-1"><a class="header-anchor" href="#三、su与sudo的对比总结"><span>三、su与sudo的对比总结</span></a></h2><table><thead><tr><th>特性</th><th>su</th><th>sudo</th></tr></thead><tbody><tr><td><strong>密码要求</strong></td><td>需要目标用户密码</td><td>需要当前用户密码</td></tr><tr><td><strong>权限控制</strong></td><td>完全权限，无限制</td><td>精确权限控制</td></tr><tr><td><strong>安全性</strong></td><td>相对较低</td><td>相对较高</td></tr><tr><td><strong>适用场景</strong></td><td>少数人管理</td><td>多人协作管理</td></tr><tr><td><strong>操作追踪</strong></td><td>难以追踪</td><td>可以记录和追踪</td></tr><tr><td><strong>配置复杂度</strong></td><td>简单</td><td>相对复杂</td></tr></tbody></table><h2 id="四、最佳实践建议" tabindex="-1"><a class="header-anchor" href="#四、最佳实践建议"><span>四、最佳实践建议</span></a></h2><ol><li><strong>单人或少数人管理</strong>：可以使用su命令</li><li><strong>多人协作管理</strong>：推荐使用sudo</li><li><strong>生产环境</strong>：优先考虑sudo，提供更好的安全性和可控性</li><li><strong>权限最小化</strong>：只授予必要的权限，避免过度授权</li><li><strong>定期审查</strong>：定期检查和更新sudo配置</li><li><strong>日志监控</strong>：监控sudo的使用日志，及时发现异常操作</li></ol><hr><p><em>注：本文档基于Linux系统环境，不同发行版可能存在细微差异。使用时请参考相应的man手册获取详细信息。</em></p>`,97)]))}const k=i(l,[["render",h]]),p=JSON.parse(`{"path":"/linux/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/su-vs-sudo.html","title":"su和sudo的区别与使用指南","lang":"zh-CN","frontmatter":{"title":"su和sudo的区别与使用指南","category":["Linux系统"],"tag":["用户管理","系统管理","权限控制","安全"],"date":"2022-08-23T00:00:00.000Z","description":"su和sudo的区别与使用指南 一、使用 su 命令临时切换用户身份 1. su 的适用条件和威力 su命令是切换用户的工具。例如，当我们以普通用户beinan登录系统，但需要执行添加用户的任务（useradd命令）时，由于beinan用户没有这个权限，而root用户拥有此权限，我们有两种解决方案： 方案一：退出beinan用户，重新以root用户登录...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"su和sudo的区别与使用指南\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-08-23T00:00:00.000Z\\",\\"dateModified\\":\\"2025-07-09T15:12:33.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"tuonioooo\\",\\"url\\":\\"/\\"}]}"],["meta",{"property":"og:url","content":"https://mister-hope.github.io/linux/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/su-vs-sudo.html"}],["meta",{"property":"og:site_name","content":"tuonioooo's DevOps Docs"}],["meta",{"property":"og:title","content":"su和sudo的区别与使用指南"}],["meta",{"property":"og:description","content":"su和sudo的区别与使用指南 一、使用 su 命令临时切换用户身份 1. su 的适用条件和威力 su命令是切换用户的工具。例如，当我们以普通用户beinan登录系统，但需要执行添加用户的任务（useradd命令）时，由于beinan用户没有这个权限，而root用户拥有此权限，我们有两种解决方案： 方案一：退出beinan用户，重新以root用户登录..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-07-09T15:12:33.000Z"}],["meta",{"property":"article:tag","content":"安全"}],["meta",{"property":"article:tag","content":"权限控制"}],["meta",{"property":"article:tag","content":"系统管理"}],["meta",{"property":"article:tag","content":"用户管理"}],["meta",{"property":"article:published_time","content":"2022-08-23T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-07-09T15:12:33.000Z"}]]},"git":{"createdTime":1752073953000,"updatedTime":1752073953000,"contributors":[{"name":"tuonioooo","username":"tuonioooo","email":"daizhaoman@sina.com","commits":1,"url":"https://github.com/tuonioooo"}]},"readingTime":{"minutes":5.52,"words":1655},"filePathRelative":"linux/用户管理工具/su-vs-sudo.md","excerpt":"\\n<h2>一、使用 su 命令临时切换用户身份</h2>\\n<h3>1. su 的适用条件和威力</h3>\\n<p>su命令是切换用户的工具。例如，当我们以普通用户beinan登录系统，但需要执行添加用户的任务（useradd命令）时，由于beinan用户没有这个权限，而root用户拥有此权限，我们有两种解决方案：</p>\\n<ol>\\n<li><strong>方案一</strong>：退出beinan用户，重新以root用户登录（不推荐）</li>\\n<li><strong>方案二</strong>：使用su命令切换到root用户执行相关操作，完成后再退出root（推荐）</li>\\n</ol>\\n<p><strong>权限特点：</strong></p>","autoDesc":true}`);export{k as comp,p as data};
